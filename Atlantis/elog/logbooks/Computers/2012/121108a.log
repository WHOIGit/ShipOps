$@MID@$: 42
Date: Thu, 08 Nov 2012 14:37:27 +0000
Author: laura
Type: Configuration
name: atguru
server type: backup
OS: Linux
Location: Computer Lab
Category: backups
Subject: incremental backups of mailhost
Cruise: at24-01
Attachment: 
Encoding: HTML
========================================
<p>put a guru plug on the ship to test an incremental backups scheme... it looks like it will work esp for mail. will see how it works while the ship is in the yard. </p>
<p>atguru&nbsp; 199.92.161.17</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>#!/bin/bash<br />
<br />
# Mailhost backup script&nbsp;&nbsp;&nbsp;&nbsp; <br />
# <br />
# This script should make incremental backups of users and mail on mailhost.<br />
# It creates hard links to files that have not changed and copies over only the<br />
# changes by date.<br />
#<br />
# The different SRC are the different directories, the home directory rsync needs to <br />
# excludes the data directories. It is running in cron and overwriting it's log to<br />
# /backups<br />
# The /backups is a 850Gig transcend drive, so if the guru plug dies, the data should<br />
# still be fine. The guru plug ran on the Knorr for months without any issues.<br />
#<br />
#<br />
<br />
<br />
#Todays date in ISO-8601 format<br />
DAY0=`date -I`<br />
<br />
#Yesterdays date in ISO-8601 format<br />
DAY1=`date -I -d &quot;1 day ago&quot;`<br />
<br />
#The source directory<br />
SRC1=&quot;linus:/var/spool/mail&quot;<br />
SRC2=&quot;linus:/home&quot;<br />
SRC3=&quot;linus:/usr/local/cmail&quot;<br />
SRC4=&quot;linus:/etc&quot;<br />
<br />
array=($SRC1 $SRC3 $SRC4)<br />
<br />
#The target directory<br />
TRG=&quot;/backups/mailhost/$DAY0&quot;<br />
<br />
#The link destination directory:<br />
LNK=&quot;/backups/mailhost/$DAY1&quot;<br />
<br />
#The rsync options:<br />
OPT1=&quot;-avh --delete --link-dest=$LNK&quot;<br />
<br />
#Execute the backup<br />
<br />
for i in &quot;${array[@]}&quot;<br />
do<br />
&nbsp;&nbsp; rsync $OPT1 $i $TRG<br />
done<br />
<br />
rsync $OPT1 --exclude 'data*' $SRC2 $TRG<br />
&nbsp;</p>
$@MID@$: 43
Date: Thu, 08 Nov 2012 14:41:04 +0000
Author: laura
Type: Configuration
name: atguru
server type: backup
OS: Linux
Location: Computer Lab
Category: backups
Subject: incremental ftp backups
Cruise: at24-01
Attachment: 
Encoding: HTML
========================================
<p>There is an incremental ftp backup script on atguru. I ran it twice on the transit, but not sure I want to run it in the shipyard..&nbsp; if the mailhost one works will put this one into service.. There are two backups of ftp on the guruplug.</p>
<p>#!/bin/bash<br />
<br />
#Mailhost backup script<br />
<br />
#Todays date in ISO-8601 format<br />
DAY0=`date -I`<br />
<br />
#Yesterdays date in ISO-8601 format<br />
DAY1=`date -I -d &quot;1 day ago&quot;`<br />
<br />
#The source directory<br />
#SRC1=&quot;ftp:/var/spool/mail&quot;<br />
SRC2=&quot;ftp:/home&quot;<br />
SRC3=&quot;ftp:/var/www&quot;<br />
SRC4=&quot;ftp:/usr/lib/cgi-bin&quot;<br />
SRC5=&quot;ftp:/usr/local/elog&quot;<br />
SRC6=&quot;ftp:/var/cache/bind&quot;<br />
SRC7=&quot;ftp:/etc&quot;<br />
<br />
#Use the array to step through the directories, do not want<br />
#data so do /home seperately<br />
<br />
array=($SRC1 $SRC4 $SRC5 $SRC6 $SRC7)<br />
<br />
#The target directory<br />
TRG=&quot;/backups/ftp/$DAY0&quot;<br />
<br />
#The link destination directory:<br />
LNK=&quot;/backups/ftp/$DAY1&quot;<br />
<br />
#The rsync options:<br />
OPT1=&quot;-avh --delete --link-dest=$LNK&quot;<br />
<br />
#Execute the backup<br />
<br />
for i in &quot;${array[@]}&quot;<br />
do<br />
&nbsp;&nbsp; rsync $OPT1 $i $TRG<br />
done<br />
<br />
rsync $OPT1 --exclude 'data*' $SRC2 $TRG<br />
rsync $OPT1 --exclude 'squid-reports' $SRC3 $TRG<br />
&nbsp;</p>
